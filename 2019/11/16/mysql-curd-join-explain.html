<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MySQL æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ - æ•¬ç»´</title>
    <meta name="author"  content="æ•¬ç»´">
    <meta name="description" content="MySQL æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹">
    <meta name="keywords"  content="æ•°æ®åº“, ç»éªŒ, å®ç”¨">
    <!-- Open Graph -->
    <meta property="og:title" content="MySQL æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹ - æ•¬ç»´">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jingwei.link/2019/11/16/mysql-curd-join-explain.html">
    <meta property="og:description" content="ä¸€ä¸ªå–œæ¬¢æ¶‚æ¶‚ç”»ç”»çš„äººï¼Œæ›¾ç»çš„Rubistï¼Œä¸€ä¸ªCI/CDçš„è·µè¡Œè€…ï¼Œä¸€ä¸ªæ¢å¯»æœ€ä½³å®è·µçš„äººã€‚">
    <meta property="og:site_name" content="æ•¬ç»´">
    <link rel="stylesheet" href="//cdn.staticfile.org/normalize/6.0.0/normalize.min.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_roc50gemkxpw4s4i.css">
    <link rel="stylesheet" href="/assets/css/github-markdown.css">
    <link rel="stylesheet" href="/assets/css/prism.css">
    <link rel="stylesheet" href="/assets/css/share.min.css">
    <link rel="stylesheet" href="/assets/css/app.min.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
	
	<!--
Author: Ray-Eldath
refer to:
 - http://docs.mathjax.org/en/latest/options/index.html
-->

	<script type="text/javascript" async src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
		jax: ["input/TeX", "output/HTML-CSS"],
		tex2jax: {
			inlineMath: [ ["$", "$"] ],
			displayMath: [ ["$$", "$$"] ],
			skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
		},
		"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
      });
    </script>

	
    <!--
Author: Ray-Eldath
-->
<style>
    .markdown-body .anchor{
        float: left;
        margin-top: -8px;
        margin-left: -20px;
        padding-right: 4px;
        line-height: 1;
        opacity: 0;
    }
    
    .markdown-body .anchor .anchor-icon{
        font-size: 15px
    }
</style>
<script>
    $(document).ready(function() {
        let nodes = document.querySelector(".markdown-body").querySelectorAll("h1,h2,h3")
        for(let node of nodes) {
            var anchor = document.createElement("a")
            var anchorIcon = document.createElement("i")
            anchorIcon.setAttribute("class", "fa fa-anchor fa-lg anchor-icon")
            anchorIcon.setAttribute("aria-hidden", true)
            anchor.setAttribute("class", "anchor")
            anchor.setAttribute("href", "#" + node.getAttribute("id"))
            
            anchor.onmouseover = function() {
                this.style.opacity = "0.4"
            }
            
            anchor.onmouseout = function() {
                this.style.opacity = "0"
            }
            
            anchor.appendChild(anchorIcon)
            node.appendChild(anchor)
        }
    })
</script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-121993438-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-121993438-1');
    </script>
</head>


<body>
  <!--[if lt IE 10]>
<div class="alert-danger" role="alert">ä½ çš„æµè§ˆå™¨å®åœ¨å¤ªå¤ªå¤ªæ—§äº†ï¼Œæ”¾å­¦åˆ«èµ°ï¼Œå‡çº§å®Œæµè§ˆå™¨å†è¯´ï¼<a target="_blank" class="alert-link" href="http://browsehappy.com">ç«‹å³å‡çº§</a></div>
<![endif]-->
  <input id="nm-switch" type="hidden" value="true"> <header class="g-header">
    <div class="g-logo">
      <a href="/"></a>
    </div>
    <i id="menu-toggle" class="iconfont icon-menu"></i>
    <nav class="g-nav">
        <ul>
            
            <li><a href="/">home</a></li>
            
            <li><a href="/tags.html">tags</a></li>
            
        </ul>
    </nav>
</header>


  <header class="g-banner post-header post-pattern-circuitBoard bgcolor-default " data-theme="default">
    <div class="post-wrapper">
      <div class="post-tags">
        
          
            <a href="https://jingwei.link/tags#%E6%95%B0%E6%8D%AE%E5%BA%93" class="post-tag">æ•°æ®åº“</a>
          
            <a href="https://jingwei.link/tags#%E7%BB%8F%E9%AA%8C" class="post-tag">ç»éªŒ</a>
          
            <a href="https://jingwei.link/tags#%E5%AE%9E%E7%94%A8" class="post-tag">å®ç”¨</a>
          
        
      </div>
      <h1>MySQL æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨ç¤ºä¾‹</h1>
      <div class="post-meta">
        <span class="post-meta-item"><i class="iconfont icon-author"></i><a href="https://jingwei.link" target="_blank" rel="author">æ•¬ç»´</a></></span>
        <time class="post-meta-item" datetime="19-11-16"><i class="iconfont icon-date"></i>16 Nov 2019</time>
      </div>
    </div>
    
    <div class="filter"></div>
      <div class="post-cover" style="background: url('') center no-repeat; background-size: cover;"></div>
    
  </header>

  <div class="post-content visible">
    
    <h2 class="post-subtitle">å°±æ•°æ®åº“çš„ä½¿ç”¨ç»™å‡º  CURDã€JOIN å’Œ EXPLAIN çš„ç¤ºä¾‹</h2>
    

    <article class="markdown-body">
      <ul id="markdown-toc">
  <li><a href="#å†™åœ¨å‰é¢" id="markdown-toc-å†™åœ¨å‰é¢">å†™åœ¨å‰é¢</a></li>
  <li><a href="#é€‚ç”¨äººç¾¤" id="markdown-toc-é€‚ç”¨äººç¾¤">é€‚ç”¨äººç¾¤</a></li>
  <li><a href="#æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨" id="markdown-toc-æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨">æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨</a>    <ul>
      <li><a href="#æ•°æ®åº“çš„å®‰è£…ä¸å¯åŠ¨" id="markdown-toc-æ•°æ®åº“çš„å®‰è£…ä¸å¯åŠ¨">æ•°æ®åº“çš„å®‰è£…ä¸å¯åŠ¨</a></li>
      <li><a href="#è¿æ¥æ•°æ®åº“æœåŠ¡" id="markdown-toc-è¿æ¥æ•°æ®åº“æœåŠ¡">è¿æ¥æ•°æ®åº“æœåŠ¡</a></li>
      <li><a href="#åˆ›å»ºæ•°æ®åº“" id="markdown-toc-åˆ›å»ºæ•°æ®åº“">åˆ›å»ºæ•°æ®åº“</a></li>
      <li><a href="#åˆ›å»ºæ•°æ®è¡¨" id="markdown-toc-åˆ›å»ºæ•°æ®è¡¨">åˆ›å»ºæ•°æ®è¡¨</a>        <ul>
          <li><a href="#åˆ›å»º-users-è¡¨" id="markdown-toc-åˆ›å»º-users-è¡¨">åˆ›å»º users è¡¨</a></li>
          <li><a href="#åˆ›å»º-blogs-è¡¨" id="markdown-toc-åˆ›å»º-blogs-è¡¨">åˆ›å»º blogs è¡¨</a></li>
          <li><a href="#åˆ›å»º-comments-è¡¨" id="markdown-toc-åˆ›å»º-comments-è¡¨">åˆ›å»º comments è¡¨</a></li>
          <li><a href="#åˆ›å»ºä¸€äº›å‡æ•°æ®ä¾¿äºåé¢æ£€ç´¢ä½¿ç”¨" id="markdown-toc-åˆ›å»ºä¸€äº›å‡æ•°æ®ä¾¿äºåé¢æ£€ç´¢ä½¿ç”¨">åˆ›å»ºä¸€äº›å‡æ•°æ®ä¾¿äºåé¢æ£€ç´¢ä½¿ç”¨</a></li>
        </ul>
      </li>
      <li><a href="#join-çš„ä½¿ç”¨" id="markdown-toc-join-çš„ä½¿ç”¨">JOIN çš„ä½¿ç”¨</a></li>
      <li><a href="#explain-çš„ä½¿ç”¨" id="markdown-toc-explain-çš„ä½¿ç”¨">EXPLAIN çš„ä½¿ç”¨</a>        <ul>
          <li><a href="#åœ¨-usersusername-å­—æ®µä¸Šæ·»åŠ ç´¢å¼•" id="markdown-toc-åœ¨-usersusername-å­—æ®µä¸Šæ·»åŠ ç´¢å¼•">åœ¨ users.username å­—æ®µä¸Šæ·»åŠ ç´¢å¼•</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#å°ç»“" id="markdown-toc-å°ç»“">å°ç»“</a></li>
  <li><a href="#å‚è€ƒ" id="markdown-toc-å‚è€ƒ">å‚è€ƒ</a></li>
</ul>

<h2 id="å†™åœ¨å‰é¢">å†™åœ¨å‰é¢</h2>
<p>å¯¹ä¸€èˆ¬çš„å¼€å‘è€…æ¥è¯´ï¼ŒMySQL å®‰è£…æˆåŠŸä»¥åï¼Œå‰©ä¸‹çš„å°±æ˜¯åŸºæœ¬çš„ä½¿ç”¨äº†ï¼Œå¦‚æœæ˜¯è¿ç»´å¼€å‘ï¼Œå¯èƒ½è¿˜ä¼šæ¶‰åŠåˆ°æ•°æ®åº“çš„è¿ç»´ã€‚æœ¬æ–‡æš‚ä¸”ä¸è€ƒè™‘è¿ç»´ä¸Šçš„æ“ä½œï¼Œä»…å°±æ•°æ®åº“çš„ä½¿ç”¨ç»™å‡ºä¸€äº›ç¤ºä¾‹ï¼Œä¸»è¦åŒ…æ‹¬ <code class="highlighter-rouge">CURD</code>ã€<code class="highlighter-rouge">JOIN</code> å’Œ <code class="highlighter-rouge">EXPLAIN</code>ã€‚</p>

<h2 id="é€‚ç”¨äººç¾¤">é€‚ç”¨äººç¾¤</h2>
<p>å…¥é—¨â€”â€”åˆçº§â€”â€”<strong>ä¸­çº§âˆš</strong>â€”â€”é«˜çº§ï¼›æœ¬æ–‡é€‚åº”ä¸­çº§åŠä»¥ä¸Šã€‚</p>

<h2 id="æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨">æ•°æ®åº“çš„åŸºæœ¬ä½¿ç”¨</h2>
<h3 id="æ•°æ®åº“çš„å®‰è£…ä¸å¯åŠ¨">æ•°æ®åº“çš„å®‰è£…ä¸å¯åŠ¨</h3>
<p>ç›®å‰å¸¸è§çš„æ“ä½œç³»ç»Ÿæœ‰ä¸‰ç±»ï¼šLinuxã€Windowsã€Macã€‚ä¸åŒå¹³å°å®‰è£…è½¯ä»¶çš„æ–¹å¼å„å¼‚ï¼Œå®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°çš„é—®é¢˜ä¹Ÿå„ä¸ç›¸åŒï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±æ‰€ä½¿ç”¨çš„å¹³å°è¿›è¡Œæ¢ç´¢ã€‚å› ä¸ºæœ¬äººä½¿ç”¨çš„æ˜¯ Macï¼Œå› æ­¤åªç»™å‡º Mac æ“ä½œç³»ç»Ÿä¸Š MySQL çš„å®‰è£…ä¸å¯åŠ¨ã€‚</p>

<p>ç®€å•æ€»ç»“ä¸‹æ¥å°±æ˜¯ä¸‹é¢å‡ ä¸ªå‘½ä»¤</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># å®‰è£… homebrewï¼Œ å‚è€ƒ https://brew.sh/</span>
/usr/bin/ruby <span class="nt">-e</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/master/install<span class="si">)</span><span class="s2">"</span>

<span class="c"># æŸ¥æ‰¾å¯ä»¥å®‰è£…çš„ mysql æ–¹æ¡ˆ</span>
brew search mysql

<span class="c"># å®‰è£… 5.7 ç‰ˆæœ¬çš„  mysql</span>
brew <span class="nb">install </span>mysql@5.7

<span class="c"># æŸ¥çœ‹ mysql@5.7 çš„å®‰è£…ä¿¡æ¯ã€å¯åŠ¨ä¿¡æ¯ç­‰</span>
brew info mysql@5.7

<span class="c"># å¼€æœºå¯åŠ¨ mysql@5.7</span>
brew services start mysql@5.7
</code></pre></div></div>

<h3 id="è¿æ¥æ•°æ®åº“æœåŠ¡">è¿æ¥æ•°æ®åº“æœåŠ¡</h3>
<p>å¯åŠ¨ MySQL åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code class="highlighter-rouge">ps -ef |grep mysql</code> æ¥æŸ¥çœ‹ä¸ MySQL ç›¸å…³çš„è¿›ç¨‹ï¼Œå¯ä»¥å‘ç° åå°ä¼šè¿è¡Œä¸€ä¸ª <code class="highlighter-rouge">mysqld</code> çš„è¿›ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬é€šå¸¸æ‰€è¯´çš„ â€œè¿æ¥æ•°æ®åº“â€ å…¶å®æŒ‡çš„æ˜¯è¿æ¥ <code class="highlighter-rouge">mysqld</code> æä¾›çš„æ•°æ®åº“æœåŠ¡ã€‚</p>

<p>ä¸€èˆ¬æœ¬åœ°ï¼ˆè‡ªå·±çš„ç”µè„‘ä¸Šé¢ï¼‰å®‰è£…å®Œ MySQL åï¼Œä¼šé»˜è®¤å®‰è£… <code class="highlighter-rouge">mysql</code> è¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥ç”¨å®ƒæ¥è¿æ¥ <code class="highlighter-rouge">mysqld</code> æä¾›çš„æœåŠ¡ï¼ˆå› ä¸ºçœŸæ­£æä¾›æ•°æ®åº“æœåŠ¡çš„æ˜¯ mysqldï¼Œæˆ–è®¸ MySQL åº”è¯¥å« MySQLD æ¯”è¾ƒå¥½ï¼Ÿ ğŸ˜†ï¼‰ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># è¿æ¥æœ¬åœ° localhost ç«¯å£ä¸º 3306 çš„æ•°æ®åº“ hello</span>
<span class="c"># ä½¿ç”¨ root ç”¨æˆ·ï¼Œä¸”è¦æ±‚è¾“å…¥å¯†ç </span>
mysql <span class="nt">-h</span> localhost <span class="nt">-P</span> 3306 <span class="nt">-D</span> hello <span class="nt">-u</span> root <span class="nt">-p</span>

<span class="c"># æˆ‘ä»¬å¯ä»¥å¿½ç•¥ -h å’Œ -P æ¥ç®€åŒ–ä¸Šé¢çš„è¯­å¥</span>
<span class="c"># ä¸‹é¢çš„è¯­å¥è¡¨ç¤ºï¼š ä»¥ root ç”¨æˆ·è¿æ¥æœ¬åœ° 3306 ç«¯å£ä¸Šçš„æ•°æ®åº“ hello</span>
mysql <span class="nt">-D</span> hello <span class="nt">-u</span> root <span class="nt">-p</span>

<span class="c"># å¦‚æœä¸éœ€è¦æŒ‡å®šè¿æ¥å“ªä¸ªæ•°æ®åº“ï¼Œè¿˜å¯ä»¥çœç•¥ -D åŠå…¶å‚æ•°</span>
mysql <span class="nt">-u</span> root <span class="nt">-p</span>

<span class="c"># å¦‚æœéœ€è¦æŒ‡å®šå­—ç¬¦é›†ä¸º utf8mb4ï¼Œéœ€è¦æ·»åŠ ï¼ˆå¦‚æœè¦å­˜å‚¨ emoji å°±å¿…é¡»è¦æŒ‡å®šè¿™ä¸ªå­—ç¬¦é›†ï¼‰</span>
mysql <span class="nt">-u</span> root <span class="nt">-p</span> <span class="nt">--default-character-set</span><span class="o">=</span>utf8mb4
</code></pre></div></div>

<h3 id="åˆ›å»ºæ•°æ®åº“">åˆ›å»ºæ•°æ®åº“</h3>
<p>è¿æ¥åˆ°æ•°æ®åº“ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„è¯­å¥åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- SQL çš„æ³¨é‡Šä½¿ç”¨çš„æ˜¯ åŒæ¨ªçº¿ â€œ--â€</span>
<span class="c1">-- å¦‚æœ hello æ•°æ®åº“å·²ç»å­˜åœ¨ï¼Œå°±æ˜¾å¼åœ°å…ˆåˆ é™¤è¿™ä¸ªæ•°æ®åº“</span>
<span class="c1">-- ç„¶ååˆ›å»ºä¸€ä¸ªåä¸º hello çš„æ•°æ®åº“ï¼Œå¹¶æŒ‡å®šå…¶é»˜è®¤çš„å­—ç¬¦é›†ä¸º utf8mb4</span>
<span class="c1">-- å¤§å®¶å¯ä»¥è‡ªè¡Œæœç´¢ MySQL utf8mb4 ç›¸å…³çš„å†…å®¹</span>
<span class="k">DROP</span> <span class="k">DATABASE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="n">hello</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="nv">`hello`</span> <span class="k">DEFAULT</span> <span class="nb">CHARACTER</span> <span class="k">SET</span> <span class="o">=</span> <span class="nv">`utf8mb4`</span><span class="p">;</span>

<span class="c1">-- æœ‰äº†æ•°æ®åº“ä»¥åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ•°æ®åº“äº†ï¼Œç„¶åæ‰å¯ä»¥åœ¨æ•°æ®åº“ä¸­åˆ›å»ºè¡¨</span>
<span class="n">USE</span> <span class="n">hello</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="åˆ›å»ºæ•°æ®è¡¨">åˆ›å»ºæ•°æ®è¡¨</h3>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¨¡ä»¿ä¸€ä¸ªåšå®¢ç³»ç»Ÿåˆ›å»ºå‡ ä¸ªæ•°æ®è¡¨ï¼Œåˆ†åˆ«åŒ…æ‹¬ç”¨æˆ·è¡¨ usersã€åšå®¢è¡¨ blogs å’Œè¯„è®ºè¡¨ commentsã€‚</p>

<p>åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™æˆ‘ä»¬æœ‰å‡ ä¸ªé»˜è®¤é¡¹ï¼Œæ•°æ®åº“å¼•æ“ä½¿ç”¨ <code class="highlighter-rouge">InnoDB</code>ï¼ˆå°ç™½ç”¨æˆ·åªéœ€è¦è®°ä½ InnoDB å¯ä»¥æ»¡è¶³ç»å¤§éƒ¨åˆ†åœºæ™¯ï¼‰ï¼Œå­—ç¬¦é›†ä½¿ç”¨ <code class="highlighter-rouge">utf8mb4</code>ã€‚ç”±äº <code class="highlighter-rouge">InnodB</code> çš„ â€œèšç°‡ç´¢å¼•â€ å’Œâ€œäºŒçº§ç´¢å¼•åŒ…å«å¼•ç”¨è¡Œçš„ä¸»é”®åˆ—â€çš„ç‰¹æ€§ï¼Œé»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªç±»å‹ä¸º <code class="highlighter-rouge">int</code> çš„ä¸»é”®  <code class="highlighter-rouge">id</code>ã€‚</p>
<h4 id="åˆ›å»º-users-è¡¨">åˆ›å»º users è¡¨</h4>

<p>ä¸‹é¢çš„è¯­å¥åˆ›å»ºäº†ç”¨æˆ· users è¡¨ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ä¸ºäº†è¯•éªŒç¯å¢ƒçš„å¹²å‡€æ•´æ´ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨ users è¡¨</span>
<span class="c1">-- å¦‚æœå·²ç»å­˜åœ¨ users è¡¨å°±å…ˆåˆ é™¤æ‰ï¼Œæ¥ç€åˆ›å»º users è¡¨</span>
<span class="c1">-- ç”¨æˆ·è¡¨ä¸­åŒ…å«çš„å­—æ®µåŠå…¶å«ä¹‰å¯ä»¥æŸ¥çœ‹ COMMENT ä¸­å¤‡æ³¨çš„å†…å®¹</span>
<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">if</span> <span class="k">EXISTS</span> <span class="n">users</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">`users`</span> <span class="p">(</span>
  <span class="nv">`id`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">COMMENT</span> <span class="s1">'ä¸»é”®ï¼Œç”¨æˆ· id'</span><span class="p">,</span>
  <span class="nv">`created_at`</span> <span class="nb">datetime</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">COMMENT</span> <span class="s1">'åˆ›å»ºæ—¶é—´'</span><span class="p">,</span>
  <span class="nv">`updated_at`</span> <span class="nb">datetime</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">COMMENT</span> <span class="s1">'æ›´æ–°æ—¶é—´'</span><span class="p">,</span>
  <span class="nv">`username`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'ç”¨æˆ·å'</span><span class="p">,</span>
  <span class="nv">`birthday`</span> <span class="nb">datetime</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'ç”Ÿæ—¥æ—¥æœŸ'</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">),</span>
  <span class="k">KEY</span> <span class="nv">`idx_user_created_at`</span> <span class="p">(</span><span class="nv">`created_at`</span><span class="p">)</span> <span class="k">USING</span> <span class="n">BTREE</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">0</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="åˆ›å»º-blogs-è¡¨">åˆ›å»º blogs è¡¨</h4>

<p>ä¸‹é¢çš„è¯­å¥åˆ›å»ºäº†åšå®¢ blogs è¡¨ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ä¸ºäº†è¯•éªŒç¯å¢ƒçš„å¹²å‡€æ•´æ´ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨ blogs è¡¨</span>
<span class="c1">-- å¦‚æœå·²ç»å­˜åœ¨ blogs è¡¨å°±å…ˆåˆ é™¤æ‰ï¼Œæ¥ç€åˆ›å»º blogs è¡¨</span>
<span class="c1">-- ç”¨æˆ·è¡¨ä¸­åŒ…å«çš„å­—æ®µåŠå…¶å«ä¹‰å¯ä»¥æŸ¥çœ‹ COMMENT ä¸­å¤‡æ³¨çš„å†…å®¹</span>
<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">if</span> <span class="k">EXISTS</span> <span class="n">blogs</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">`blogs`</span> <span class="p">(</span>
  <span class="nv">`id`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">COMMENT</span> <span class="s1">'ä¸»é”®ï¼Œåšå®¢ id'</span><span class="p">,</span>
  <span class="nv">`created_at`</span> <span class="nb">datetime</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">COMMENT</span> <span class="s1">'åˆ›å»ºæ—¶é—´'</span><span class="p">,</span>
  <span class="nv">`updated_at`</span> <span class="nb">datetime</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">COMMENT</span> <span class="s1">'æ›´æ–°æ—¶é—´'</span><span class="p">,</span>
  <span class="nv">`user_id`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'ç”¨æˆ·id'</span><span class="p">,</span>
  <span class="nv">`title`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'åšå®¢æ ‡é¢˜ï¼Œæœ€å¤š 50 ä¸ªå­—ç¬¦'</span><span class="p">,</span>
  <span class="nv">`content`</span> <span class="nb">text</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'åšå®¢å†…å®¹'</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">),</span>
  <span class="k">KEY</span> <span class="nv">`idx_blogs_created_at`</span> <span class="p">(</span><span class="nv">`created_at`</span><span class="p">)</span> <span class="k">USING</span> <span class="n">BTREE</span><span class="p">,</span>
  <span class="k">KEY</span> <span class="nv">`idx_blogs_user_id`</span> <span class="p">(</span><span class="nv">`user_id`</span><span class="p">)</span> <span class="k">USING</span> <span class="n">BTREE</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">0</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="åˆ›å»º-comments-è¡¨">åˆ›å»º comments è¡¨</h4>

<p>ä¸‹é¢çš„è¯­å¥åˆ›å»ºäº†è¯„è®º comments è¡¨ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- ä¸ºäº†è¯•éªŒç¯å¢ƒçš„å¹²å‡€æ•´æ´ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦å·²ç»å­˜åœ¨ comments è¡¨</span>
<span class="c1">-- å¦‚æœå·²ç»å­˜åœ¨ comments è¡¨å°±å…ˆåˆ é™¤æ‰ï¼Œæ¥ç€åˆ›å»º comments è¡¨</span>
<span class="c1">-- ç”¨æˆ·è¡¨ä¸­åŒ…å«çš„å­—æ®µåŠå…¶å«ä¹‰å¯ä»¥æŸ¥çœ‹ COMMENT ä¸­å¤‡æ³¨çš„å†…å®¹</span>
<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">if</span> <span class="k">EXISTS</span> <span class="n">comments</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nv">`comments`</span> <span class="p">(</span>
  <span class="nv">`id`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">COMMENT</span> <span class="s1">'ä¸»é”®ï¼Œè¯„è®º id'</span><span class="p">,</span>
  <span class="nv">`created_at`</span> <span class="nb">datetime</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">COMMENT</span> <span class="s1">'åˆ›å»ºæ—¶é—´'</span><span class="p">,</span>
  <span class="nv">`updated_at`</span> <span class="nb">datetime</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CURRENT_TIMESTAMP</span> <span class="k">COMMENT</span> <span class="s1">'æ›´æ–°æ—¶é—´'</span><span class="p">,</span>
  <span class="nv">`user_id`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'ç”¨æˆ· id'</span><span class="p">,</span>
  <span class="nv">`blog_id`</span> <span class="nb">int</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'åšå®¢ id'</span><span class="p">,</span>
  <span class="nv">`content`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="s1">'è¯„è®ºå†…å®¹ï¼Œé™åˆ¶æœ€å¤š 2048 ä¸ªå­—ç¬¦'</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">),</span>
  <span class="k">KEY</span> <span class="nv">`idx_blogs_created_at`</span> <span class="p">(</span><span class="nv">`created_at`</span><span class="p">)</span> <span class="k">USING</span> <span class="n">BTREE</span><span class="p">,</span>
  <span class="k">KEY</span> <span class="nv">`idx_blogs_user_id`</span> <span class="p">(</span><span class="nv">`user_id`</span><span class="p">)</span> <span class="k">USING</span> <span class="n">BTREE</span><span class="p">,</span>
  <span class="k">KEY</span> <span class="nv">`idx_blogs_blog_id`</span> <span class="p">(</span><span class="nv">`blog_id`</span><span class="p">)</span> <span class="k">USING</span> <span class="n">BTREE</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="n">AUTO_INCREMENT</span><span class="o">=</span><span class="mi">0</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="åˆ›å»ºä¸€äº›å‡æ•°æ®ä¾¿äºåé¢æ£€ç´¢ä½¿ç”¨">åˆ›å»ºä¸€äº›å‡æ•°æ®ä¾¿äºåé¢æ£€ç´¢ä½¿ç”¨</h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- é¦–å…ˆä¸‹é¢æ‰‹åŠ¨ç»™æ¯ä¸ªè¡¨æ’å…¥äº†ä¸€æ¡è®°å½•</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`users`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span> <span class="nv">`username`</span><span class="p">,</span> <span class="nv">`birthday`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="s1">'ws_by_hand_1'</span><span class="p">,</span> <span class="k">NULL</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`blogs`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span> <span class="nv">`user_id`</span><span class="p">,</span> <span class="nv">`title`</span><span class="p">,</span> <span class="nv">`content`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'æµ·ç‡•'</span><span class="p">,</span> <span class="s1">'é«˜å°”åŸºçš„ä½œå“ã€‚'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`blogs`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span> <span class="nv">`user_id`</span><span class="p">,</span> <span class="nv">`title`</span><span class="p">,</span> <span class="nv">`content`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'æˆ‘çš„å¤§å­¦'</span><span class="p">,</span> <span class="s1">'é«˜å°”åŸºçš„å¦ä¸€éƒ¨ä½œå“ã€‚'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`comments`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span> <span class="nv">`user_id`</span><span class="p">,</span> <span class="nv">`blog_id`</span><span class="p">,</span> <span class="nv">`content`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'æˆ‘ä¹Ÿå–œæ¬¢é«˜å°”åŸºçš„ä½œå“ğŸ˜†'</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`comments`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span> <span class="nv">`user_id`</span><span class="p">,</span> <span class="nv">`blog_id`</span><span class="p">,</span> <span class="nv">`content`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="s1">'1'</span><span class="p">,</span> <span class="s1">'2'</span><span class="p">,</span> <span class="s1">'è¿™ä¸€éƒ¨æˆ‘ä¹Ÿå¾ˆå–œæ¬¢ğŸ˜†'</span><span class="p">);</span>

<span class="c1">-- ä¸ºäº†è¯´æ˜é—®é¢˜ï¼Œä¸‹é¢å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¤šä¸ªè™šæ‹Ÿç”¨æˆ·çš„è¿‡ç¨‹</span>
<span class="k">DELIMITER</span> <span class="p">;;</span>
<span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="n">if</span> <span class="k">EXISTS</span> <span class="n">mock_users</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="n">mock_users</span><span class="p">()</span>
<span class="k">BEGIN</span>
  <span class="k">DECLARE</span> <span class="n">i</span> <span class="nb">INT</span><span class="p">;</span>
  <span class="k">SET</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">WHILE</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1000</span> <span class="k">DO</span>
    <span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`users`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span> <span class="nv">`username`</span><span class="p">,</span> <span class="nv">`birthday`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="n">CONCAT</span><span class="p">(</span><span class="nv">"ws_auto_"</span><span class="p">,</span><span class="n">i</span><span class="p">),</span> <span class="k">NULL</span><span class="p">);</span>
    <span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`blogs`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span> <span class="nv">`user_id`</span><span class="p">,</span> <span class="nv">`title`</span><span class="p">,</span> <span class="nv">`content`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">'èƒŒå½±'</span><span class="p">,</span> <span class="s1">'æœ±è‡ªæ¸…çš„ä½œå“ã€‚'</span><span class="p">);</span>
    <span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">`comments`</span> <span class="p">(</span><span class="nv">`id`</span><span class="p">,</span> <span class="nv">`user_id`</span><span class="p">,</span> <span class="nv">`blog_id`</span><span class="p">,</span> <span class="nv">`content`</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">'æˆ‘ä¹Ÿå–œæ¬¢ğŸ˜†'</span><span class="p">);</span>
   <span class="k">SET</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">END</span> <span class="n">WHILE</span><span class="p">;</span>
<span class="k">END</span> <span class="p">;;</span>
<span class="k">DELIMITER</span> <span class="p">;</span>

<span class="c1">-- è°ƒç”¨ mock_users ç”Ÿæˆå¤šä¸ªç”¨æˆ·è´¦æˆ·ï¼Œä»¥åŠå¯¹åº”çš„ blogs å’Œ comments</span>
<span class="k">CALL</span> <span class="n">mock_users</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="join-çš„ä½¿ç”¨">JOIN çš„ä½¿ç”¨</h3>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ JOIN çš„æ–¹å¼æ¥è·å–æŸä¸ªç”¨æˆ·å‘è¡¨çš„åšå®¢çš„æ‰€æœ‰å†…å®¹ï¼Œä»¥åŠå…¶åšå®¢æ‰€è·å¾—çš„è¯„è®ºå†…å®¹ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">u</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">user_id</span><span class="p">,</span>
       <span class="n">u</span><span class="p">.</span><span class="n">username</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">blog_id</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">blog_title</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="n">content</span> <span class="k">as</span> <span class="n">blog_content</span><span class="p">,</span>
       <span class="k">c</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">comment_id</span><span class="p">,</span>
       <span class="k">c</span><span class="p">.</span><span class="n">user_id</span> <span class="k">as</span> <span class="n">comment_user_id</span><span class="p">,</span>
       <span class="k">c</span><span class="p">.</span><span class="n">content</span> <span class="k">as</span> <span class="n">comment_content</span><span class="p">,</span>
       <span class="n">cu</span><span class="p">.</span><span class="n">username</span> <span class="k">as</span> <span class="n">comment_username</span>
<span class="k">FROM</span> <span class="n">users</span> <span class="k">as</span> <span class="n">u</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">blogs</span> <span class="k">as</span> <span class="n">b</span> <span class="k">ON</span> <span class="n">b</span><span class="p">.</span><span class="n">user_id</span><span class="o">=</span><span class="n">u</span><span class="p">.</span><span class="n">id</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">comments</span> <span class="k">as</span> <span class="k">c</span> <span class="k">ON</span> <span class="k">c</span><span class="p">.</span><span class="n">blog_id</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">id</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">users</span> <span class="k">as</span> <span class="n">cu</span> <span class="k">ON</span> <span class="n">cu</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="k">c</span><span class="p">.</span><span class="n">user_id</span>
<span class="k">WHERE</span> <span class="n">u</span><span class="p">.</span><span class="n">username</span><span class="o">=</span><span class="s1">'ws_by_hand_1'</span><span class="p">;</span>
</code></pre></div></div>

<p>è·å–åˆ°çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå¯ä»¥é€šè¿‡æŒ‡å®šå­—æ®µæ¥é€‰æ‹©æ€§çš„æ£€å‡ºå¯¹åº”çš„å­—æ®µçš„å†…å®¹ï¼‰ï¼š</p>

<p><img src="/assets/pic/mysql-curd-join-explain-01.png" alt="" /></p>

<h3 id="explain-çš„ä½¿ç”¨">EXPLAIN çš„ä½¿ç”¨</h3>
<p>å› ä¸ºæˆ‘ä»¬çš„è¡¨çš„å†…å®¹æ¯”è¾ƒå°‘ï¼Œå› æ­¤è¿è¡Œä¸Šé¢ <code class="highlighter-rouge">JOIN</code> çš„å†…å®¹ä¸ä¼šæœ‰æ…¢çš„æ„Ÿè§‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¾ç„¶å¯ä»¥ä½¿ç”¨ <code class="highlighter-rouge">EXPLAIN</code> è¿›è¡Œä¸€ç•ªæ¢ç´¢ã€‚</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">EXPLAIN</span>
<span class="k">SELECT</span> <span class="n">u</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">user_id</span><span class="p">,</span>
       <span class="n">u</span><span class="p">.</span><span class="n">username</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">blog_id</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="n">title</span> <span class="k">as</span> <span class="n">blog_title</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="n">content</span> <span class="k">as</span> <span class="n">blog_content</span><span class="p">,</span>
       <span class="k">c</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">comment_id</span><span class="p">,</span>
       <span class="k">c</span><span class="p">.</span><span class="n">user_id</span> <span class="k">as</span> <span class="n">comment_user_id</span><span class="p">,</span>
       <span class="k">c</span><span class="p">.</span><span class="n">content</span> <span class="k">as</span> <span class="n">comment_content</span><span class="p">,</span>
       <span class="n">cu</span><span class="p">.</span><span class="n">username</span> <span class="k">as</span> <span class="n">comment_username</span>
<span class="k">FROM</span> <span class="n">users</span> <span class="k">as</span> <span class="n">u</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">blogs</span> <span class="k">as</span> <span class="n">b</span> <span class="k">ON</span> <span class="n">b</span><span class="p">.</span><span class="n">user_id</span><span class="o">=</span><span class="n">u</span><span class="p">.</span><span class="n">id</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">comments</span> <span class="k">as</span> <span class="k">c</span> <span class="k">ON</span> <span class="k">c</span><span class="p">.</span><span class="n">blog_id</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">id</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">users</span> <span class="k">as</span> <span class="n">cu</span> <span class="k">ON</span> <span class="n">cu</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="k">c</span><span class="p">.</span><span class="n">user_id</span>
<span class="k">WHERE</span> <span class="n">u</span><span class="p">.</span><span class="n">username</span><span class="o">=</span><span class="s1">'ws_by_hand_1'</span><span class="p">;</span>
</code></pre></div></div>

<p>ä¸Šé¢çš„ <code class="highlighter-rouge">EXPALIN</code> ä»£ç è¿è¡Œåå¾—åˆ°çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹ <code class="highlighter-rouge">type</code> ä¸€åˆ—æ¢ç´¢ç´¢å¼•çš„ä½¿ç”¨æƒ…å†µï¼Œå‘ç° <code class="highlighter-rouge">users as u</code> è¡¨æ‰«äº†å…¨é‡è¡¨ï¼ˆ<em>type ä¸º ALL</em>ï¼‰ï¼Œå½“æˆ‘ä»¬çš„ user è¡¨éå¸¸å¤§çš„æƒ…å†µä¸‹ï¼Œè¿™é‡Œè‚¯å®šä¼šå­˜åœ¨é—®é¢˜ã€‚å…¶å®åœ¨åˆ›å»º <code class="highlighter-rouge">users</code> è¡¨çš„æ—¶å€™æˆ‘åˆ»æ„å°‘åˆ›å»ºäº†ä¸€ä¸ªç´¢å¼•ï¼Œç†è®ºä¸Šåº”è¯¥åœ¨ <code class="highlighter-rouge">users.username</code> è¿™ä¸ªå­—æ®µä¸Šæ·»åŠ ç´¢å¼•ã€‚</p>

<p><img src="/assets/pic/mysql-curd-join-explain-02.png" alt="" /></p>

<h4 id="åœ¨-usersusername-å­—æ®µä¸Šæ·»åŠ ç´¢å¼•">åœ¨ users.username å­—æ®µä¸Šæ·»åŠ ç´¢å¼•</h4>

<p>å¯ä»¥é€šè¿‡ä¸‹é¢çš„è¯­å¥ä¸º <code class="highlighter-rouge">users.username</code> å­—æ®µæ·»åŠ ç´¢å¼•ï¼š</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="nv">`users`</span> <span class="k">ADD</span> <span class="k">INDEX</span> <span class="nv">`idx_user_username`</span> <span class="p">(</span><span class="nv">`username`</span><span class="p">);</span>
</code></pre></div></div>

<p>åœ¨æ·»åŠ å®Œç´¢å¼•ä»¥åï¼Œåœ¨æ­¤ <code class="highlighter-rouge">EXPLAIN</code> æˆ‘ä»¬çš„ <code class="highlighter-rouge">JOIN</code> è¯­å¥ï¼Œå¯ä»¥å¾—åˆ°ä¸‹å›¾çš„ç»“æœã€‚å¯ä»¥å‘ç° <code class="highlighter-rouge">users as u</code>çš„ type å·²ç»å˜æˆäº†å­—æ®µ <code class="highlighter-rouge">username</code> ï¼ˆ<code class="highlighter-rouge">idx_user_username</code>ï¼‰ä¸Šçš„ç´¢å¼•<code class="highlighter-rouge">ref</code>ã€‚</p>

<p><img src="/assets/pic/mysql-curd-join-explain-03.png" alt="" /></p>

<h2 id="å°ç»“">å°ç»“</h2>
<p>æœ¬æ–‡å°±æ•°æ®åº“çš„ä½¿ç”¨ç»™å‡ºä¸€äº›ç¤ºä¾‹ï¼Œé€šè¿‡å®ä¾‹ä»£ç çš„æ–¹å¼ç»™å‡º <code class="highlighter-rouge">CURD</code>ã€<code class="highlighter-rouge">JOIN</code> å’Œ <code class="highlighter-rouge">EXPLAIN</code>çš„ä½¿ç”¨æ–¹å¼ï¼Œåœ¨å®é™…ç”Ÿäº§è¿‡ç¨‹ä¸­å¯ä»¥ä¸ºå¤§å®¶æä¾›ä¸€äº›å‚è€ƒã€‚
å¯¹äº ORM å·¥å…·çš„ä½¿ç”¨ï¼Œåœ¨æ£€ç´¢çš„è¿‡ç¨‹ä¸­æœ¬è´¨æ˜¯ SQL è¯­å¥çš„æ‹¼è£…ã€æ£€ç´¢ç»“æœçš„è§£æï¼Œåœ¨æ•°æ®åº“å±‚é¢äº†è§£ SQL æ— ç–‘èƒ½å¤Ÿå¢å¼ºå¤§å®¶å¯¹ ORM çš„ä½¿ç”¨çš„ç†è§£ï¼Œä»è€Œå†™å‡ºæ›´åŠ é«˜æ•ˆå¯é çš„ä»£ç ã€‚</p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
  <li><a href="https://brew.sh/">The missing package manager for macOS (or Linux) â€” Homebrew</a> macOS ä¸Šå¼ºå¤§çš„åŒ…ç®¡ç†å™¨</li>
  <li><a href="https://www.cnblogs.com/tufujie/p/9413852.html">MySQL Explainè¯¦è§£ - åšå®¢å›­</a> æ¯”è¾ƒè¯¦å°½çš„ä»‹ç» explain çš„å†…å®¹</li>
  <li><a href="/2019/10/19/mac-mysql-reinstall.html">å¸è½½ macOS ä¸­çš„ MySQL æ—¶é‡åˆ°çš„ç–‘é—® - æ•¬ç»´</a> åœ¨ macOS ä¸Šå®‰è£…/å¸è½½ mysql çš„ä»‹ç»</li>
</ul>

    </article>

    
    <div class="social-share-wrapper">
      <div class="social-share"></div>
    </div>
    
  </div>

  <section class="author-detail">
    <section class="post-footer-item author-card">
      <div class="avatar">
        <img src="https://jingwei.link/assets/img/profile.png" alt="">
      </div>
      <div class="author-name" rel="author">æ•¬ç»´</div>
      <div class="bio">
        <p>Stay hungry, stay foolish</p>
      </div>
      
      <ul class="sns-links">
        
        <li>
          <a href="mailto:zhjw43@163.com" target="_blank">
                    <i class="iconfont icon-email"></i>
                </a>
        </li>
        
        <li>
          <a href="https://github.com/chalvern" target="_blank">
                    <i class="iconfont icon-github"></i>
                </a>
        </li>
        
        <li>
          <a href="https://weibo.com/zhjw43" target="_blank">
                    <i class="iconfont icon-weibo"></i>
                </a>
        </li>
        
      </ul>
      
    </section>
    <section class="post-footer-item read-next">
      

      
      <div class="read-next-item">
        <a href="/2019/11/09/effectivego-interface.html" class="read-next-link"></a>
          <section>
            <span>ã€ŠåŸæ±åŸå‘³ Go è¯­è¨€å­¦ä¹ ã€‹(9) effective go æ¥å£åŠæ³›å‹</span>
            <p></p>
          </section>
          
          <div class="filter"></div>
          <img src="" alt="">
          
      </div>
      
    </section>
    <section class="post-footer-item comment">
      <div id="disqus_thread"></div>
    </section>
  </section>

  <footer class="g-footer">
  <section>æ•¬ç»´ Â©
  
  
    2018
    -
  
  2019
  <a href="/rss.xml">RSSè®¢é˜…</a>
  </section>
</footer>


  <script src="/assets/js/social-share.min.js"></script>
  <script>
    socialShare('.social-share', {
      sites: [
        
          'wechat'
          ,
          
        
          'weibo'
          ,
          
        
          'douban'
          ,
          
        
          'twitter'
          
        
      ],
      wechatQrcodeTitle: "åˆ†äº«åˆ°å¾®ä¿¡æœ‹å‹åœˆ",
      wechatQrcodeHelper: '<p>æ‰«ç åç‚¹å‡»å³ä¸Šè§’</p><p>å°†æœ¬æ–‡åˆ†äº«è‡³æœ‹å‹åœˆ</p>'
    });
  </script>

  

  <script src="/assets/js/prism.js"></script>
  <script src="/assets/js/index.min.js"></script>
</body>

</html>
